"use strict";(self.webpackChunknwitter=self.webpackChunknwitter||[]).push([[825],{3825:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r,a=n(1413),s=n(885),c=n(2791),o=n(3870),i=n(9062),u=n(4165),l=n(5861),f=n(4453),d=n(4483),p=n(3174),m=n(184),h=function(e){var t=e.nweetObj,n=e.isOwner,r=(0,c.useState)(!1),a=(0,s.Z)(r,2),h=a[0],x=a[1],v=(0,c.useState)(t.text),w=(0,s.Z)(v,2),j=w[0],y=w[1],g=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(){var n,r,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.confirm("Are you sure you want to delete this nweet?"),r=(0,i.JU)(o.wO,"nweets","".concat(t.id)),a=(0,f.iH)(o.Hw,t.attachmentUrl),!n){e.next=8;break}return e.next=6,(0,i.oe)(r);case 6:return e.next=8,(0,f.oq)(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){return x((function(e){return!e}))},C=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(n){var r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=(0,i.JU)(o.wO,"nweets","".concat(t.id)),e.next=4,(0,i.r7)(r,{text:j});case 4:console.log(t,j),x(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsx)("div",{className:"nweet",children:h?(0,m.jsx)(m.Fragment,{children:n&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("form",{onSubmit:C,className:"container nweetEdit",children:[(0,m.jsx)("input",{type:"text",placeholder:"Edit your nweet",value:j,required:!0,onChange:function(e){var t=e.target.value;y(t)},autoFocus:!0,className:"formInput"}),(0,m.jsx)("input",{type:"submit",value:"Update Nweet",className:"formBtn"})]}),(0,m.jsx)("span",{onClick:b,className:"formBtn cancelBtn",children:"Cancel"})]})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h4",{children:t.text}),t.attachmentUrl&&(0,m.jsx)("img",{src:t.attachmentUrl}),n&&(0,m.jsxs)("div",{className:"nweet__actions",children:[(0,m.jsx)("span",{onClick:g,children:(0,m.jsx)(d.G,{icon:p.$aW})}),(0,m.jsx)("span",{onClick:b,children:(0,m.jsx)(d.G,{icon:p.UJf})})]})]})})},x=new Uint8Array(16);function v(){if(!r&&!(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(x)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var j=function(e){return"string"===typeof e&&w.test(e)},y=[],g=0;g<256;++g)y.push((g+256).toString(16).substr(1));var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase();if(!j(n))throw TypeError("Stringified UUID is invalid");return n};var C=function(e,t,n){var r=(e=e||{}).random||(e.rng||v)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return b(r)},k=function(e){var t=e.userObj,n=(0,c.useState)(""),r=(0,s.Z)(n,2),a=r[0],h=r[1],x=(0,c.useState)(""),v=(0,s.Z)(x,2),w=v[0],j=v[1],y=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(n){var r,s,c,l,d;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return");case 2:if(n.preventDefault(),r="".concat(t.uid,"/").concat(C()),s=(0,f.iH)(o.CE,r),c="",e.prev=6,""===w){e.next=15;break}return e.next=10,(0,f.sf)(s,w,"data_url");case 10:return l=e.sent,console.log(l),e.next=14,(0,f.Jt)(s);case 14:c=e.sent;case 15:return d=(0,i.hJ)(o.wO,"nweets"),e.next=18,(0,i.ET)(d,{text:a,createdAt:Date.now(),creatorId:t.uid,attachmentUrl:c});case 18:h(""),j(""),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(6),console.log(e.t0);case 25:case"end":return e.stop()}}),e,null,[[6,22]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)("form",{onSubmit:y,className:"factoryForm",children:[(0,m.jsxs)("div",{className:"factoryInput__container",children:[(0,m.jsx)("input",{className:"factoryInput__input",value:a,onChange:function(e){var t=e.target.value;h(t)},type:"text",placeholder:"What's on your mind?",maxLength:120}),(0,m.jsx)("input",{type:"submit",value:"\u2192",className:"factoryInput__arrow"})]}),(0,m.jsxs)("label",{htmlFor:"attach-file",className:"factoryInput__label",children:[(0,m.jsx)("span",{children:"Add photos"}),(0,m.jsx)(d.G,{icon:p.r8p})]}),(0,m.jsx)("input",{id:"attach-file",type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){var t=e.currentTarget.result;j(t)},n.readAsDataURL(t)},style:{opacity:0}}),w&&(0,m.jsxs)("div",{className:"factoryForm__attachment",children:[(0,m.jsx)("img",{src:w,style:{backgroundImage:w}}),(0,m.jsxs)("div",{className:"factoryForm__clear",onClick:function(){return j("")},children:[(0,m.jsx)("span",{children:"Remove"}),(0,m.jsx)(d.G,{icon:p.NBC})]})]})]})},N=function(e){var t=e.userObj,n=(0,c.useState)([]),r=(0,s.Z)(n,2),u=r[0],l=r[1];return(0,c.useEffect)((function(){var e=(0,i.IO)((0,i.hJ)(o.wO,"nweets"),(0,i.Xo)("createdAt","desc")),t=(0,i.cf)(e,(function(e){var t=[];e.forEach((function(e){t.push((0,a.Z)({id:e.id},e.data()))})),l(t)}));return function(){t()}}),[]),(0,m.jsxs)("div",{className:"container",children:[(0,m.jsx)(k,{userObj:t}),(0,m.jsx)("div",{style:{marginTop:30},children:u.map((function(e){return(0,m.jsx)(h,{nweetObj:e,isOwner:e.creatorId===t.uid},e.id)}))})]})}}}]);
//# sourceMappingURL=825.90ddc7e8.chunk.js.map